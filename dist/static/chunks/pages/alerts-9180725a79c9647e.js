(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[233],{5718:function(e,s,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/alerts",function(){return t(6335)}])},6335:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return o}});var r=t(5893),a=t(7294),l=t(3755),n=t(6706),i=t(7066),c=t(6501);function o(){let{user:e}=(0,n.a)(),[s,t]=(0,a.useState)([]),[o,d]=(0,a.useState)(!0),[m,u]=(0,a.useState)(!1),[x,h]=(0,a.useState)({criteria:{},frequency:"daily",active:!0});(0,a.useEffect)(()=>{e&&f()},[e]);let f=async()=>{try{d(!0);let e=await i.Z.get("/api/alerts");t(e.data.alerts)}catch(e){c.ZP.error("Erreur lors du chargement des alertes")}finally{d(!1)}},p=async e=>{e.preventDefault();try{let e=await i.Z.post("/api/alerts",x);t(s=>[...s,e.data.alert]),u(!1),h({criteria:{},frequency:"daily",active:!0}),c.ZP.success("Alerte cr\xe9\xe9e avec succ\xe8s")}catch(e){c.ZP.error("Erreur lors de la cr\xe9ation de l'alerte")}},j=async(e,s)=>{try{await i.Z.put("/api/alerts?alertId=".concat(e),s),t(t=>t.map(t=>t.id===e?{...t,...s}:t)),c.ZP.success("Alerte mise \xe0 jour")}catch(e){c.ZP.error("Erreur lors de la mise \xe0 jour de l'alerte")}},v=async e=>{if(window.confirm("\xcates-vous s\xfbr de vouloir supprimer cette alerte ?"))try{await i.Z.delete("/api/alerts?alertId=".concat(e)),t(s=>s.filter(s=>s.id!==e)),c.ZP.success("Alerte supprim\xe9e")}catch(e){c.ZP.error("Erreur lors de la suppression de l'alerte")}};return e?(0,r.jsx)(l.Z,{children:(0,r.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Mes alertes"}),(0,r.jsxs)("button",{onClick:()=>u(!0),className:"inline-flex items-center px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,r.jsx)("svg",{className:"-ml-1 mr-2 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Cr\xe9er une alerte"]})]}),o?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):s.length>0?(0,r.jsx)("div",{className:"space-y-6",children:s.map(e=>(0,r.jsxs)("div",{className:"bg-white shadow rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("div",{className:"h-3 w-3 rounded-full ".concat(e.active?"bg-green-500":"bg-gray-300")}),(0,r.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Alerte ",e.id.slice(0,8)]})]}),(0,r.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,r.jsx)("button",{onClick:()=>j(e.id,{active:!e.active}),className:"text-sm text-gray-600 hover:text-gray-900",children:e.active?"D\xe9sactiver":"Activer"}),(0,r.jsx)("button",{onClick:()=>v(e.id),className:"text-sm text-red-600 hover:text-red-900",children:"Supprimer"})]})]}),(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Crit\xe8res"}),(0,r.jsx)("ul",{className:"space-y-2",children:Object.entries(e.criteria).map(e=>{let[s,t]=e;return(0,r.jsxs)("li",{className:"text-sm text-gray-700",children:[(0,r.jsxs)("span",{className:"font-medium",children:[s,": "]}),Array.isArray(t)?t.join(", "):t]},s)})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h4",{className:"text-sm font-medium text-gray-500 mb-2",children:"Param\xe8tres"}),(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Fr\xe9quence: "}),"daily"===e.frequency?"Quotidienne":"Hebdomadaire"]}),(0,r.jsxs)("p",{className:"text-sm text-gray-700",children:[(0,r.jsx)("span",{className:"font-medium",children:"Cr\xe9\xe9e le: "}),new Date(e.createdAt).toLocaleDateString("fr-FR")]})]})]})]},e.id))}):(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),(0,r.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"Aucune alerte"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Cr\xe9ez votre premi\xe8re alerte pour \xeatre notifi\xe9 des nouvelles annonces."})]}),m&&(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center p-4",children:(0,r.jsxs)("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Cr\xe9er une nouvelle alerte"}),(0,r.jsx)("button",{onClick:()=>u(!1),className:"text-gray-400 hover:text-gray-500",children:(0,r.jsx)("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,r.jsxs)("form",{onSubmit:p,children:[(0,r.jsx)("div",{className:"mt-6 space-y-4",children:(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Fr\xe9quence"}),(0,r.jsxs)("select",{value:x.frequency,onChange:e=>h(s=>({...s,frequency:e.target.value})),className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500",children:[(0,r.jsx)("option",{value:"daily",children:"Quotidienne"}),(0,r.jsx)("option",{value:"weekly",children:"Hebdomadaire"})]})]})}),(0,r.jsxs)("div",{className:"mt-6 flex justify-end space-x-4",children:[(0,r.jsx)("button",{type:"button",onClick:()=>u(!1),className:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Annuler"}),(0,r.jsx)("button",{type:"submit",className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cr\xe9er l'alerte"})]})]})]})})]})}):(0,r.jsx)(l.Z,{children:(0,r.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12",children:(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})}),(0,r.jsx)("h2",{className:"mt-2 text-lg font-medium text-gray-900",children:"Connectez-vous pour g\xe9rer vos alertes"}),(0,r.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Vous devez \xeatre connect\xe9 pour acc\xe9der \xe0 vos alertes."})]})})})}}},function(e){e.O(0,[424,128,755,888,774,179],function(){return e(e.s=5718)}),_N_E=e.O()}]);