(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[603],{8266:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/search",function(){return r(6398)}])},1370:function(e,t,r){"use strict";r.d(t,{Z:function(){return m}});var a=r(5893),s=r(7294),l=r(5675),n=r.n(l),i=r(1664),o=r.n(i),c=r(6706),d=r(7066),u=r(6501);function m(e){var t,r;let{car:l,isFavorite:i=!1,onFavoriteToggle:m}=e,{user:x}=(0,c.a)(),[h,g]=(0,s.useState)(!1),b=async()=>{if(!x){u.ZP.error("Vous devez \xeatre connect\xe9 pour ajouter des favoris");return}try{g(!0),i?(await d.Z.delete("/api/favorites",{data:{carId:l._id}}),u.ZP.success("Retir\xe9 des favoris")):(await d.Z.post("/api/favorites",{carId:l._id}),u.ZP.success("Ajout\xe9 aux favoris")),null==m||m()}catch(e){u.ZP.error("Une erreur est survenue")}finally{g(!1)}};return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[(0,a.jsxs)("div",{className:"relative h-48",children:[l.images.length>0?(0,a.jsx)(n(),{src:l.images[0],alt:l.title,fill:!0,className:"object-cover"}):(0,a.jsx)("div",{className:"w-full h-full bg-gray-200 flex items-center justify-center",children:(0,a.jsx)("svg",{className:"w-12 h-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})})}),(0,a.jsx)("button",{onClick:b,disabled:h,className:"absolute top-2 right-2 p-2 rounded-full bg-white shadow-md hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:(0,a.jsx)("svg",{className:"w-6 h-6 ".concat(i?"text-red-500":"text-gray-400"),fill:i?"currentColor":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})]}),(0,a.jsx)("div",{className:"p-4",children:(0,a.jsxs)(o(),{href:"/cars/".concat(l._id),className:"block",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-1",children:l.title}),(0,a.jsx)("p",{className:"text-2xl font-bold text-blue-600 mb-2",children:(t=l.price,new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(t))}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Ann\xe9e :"})," ",l.year]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Kilom\xe9trage :"})," ",l.mileage.toLocaleString("fr-FR")," km"]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Carburant :"})," ",l.fuel.charAt(0).toUpperCase()+l.fuel.slice(1)]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"font-medium",children:"Bo\xeete :"})," ",l.transmission.charAt(0).toUpperCase()+l.transmission.slice(1)]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-sm text-gray-500",children:[(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsxs)("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),l.location.city," (",l.location.department,")"]}),(0,a.jsx)("div",{children:(r=l.createdAt,new Intl.DateTimeFormat("fr-FR",{day:"numeric",month:"long",year:"numeric"}).format(new Date(r)))})]})]})})]})}},6398:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return C}});var a=r(5893),s=r(7294),l=r(1163),n=r(3755),i=r(9554),o=r.n(i);function c(e){let{min:t,max:r,step:l=1e3,initialMin:n=t,initialMax:i=r,onChange:c}=e,[d,u]=(0,s.useState)(n),[m,x]=(0,s.useState)(i);(0,s.useEffect)(()=>{u(n),x(i)},[n,i]);let h=e=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(e);return(0,a.jsxs)("div",{className:"jsx-4d3a686f648d85ae w-full px-2",children:[(0,a.jsxs)("div",{className:"jsx-4d3a686f648d85ae flex justify-between mb-2",children:[(0,a.jsx)("span",{className:"jsx-4d3a686f648d85ae text-sm text-gray-600",children:h(d)}),(0,a.jsx)("span",{className:"jsx-4d3a686f648d85ae text-sm text-gray-600",children:h(m)})]}),(0,a.jsxs)("div",{className:"jsx-4d3a686f648d85ae relative h-2",children:[(0,a.jsx)("div",{className:"jsx-4d3a686f648d85ae absolute w-full h-1 bg-gray-200 rounded top-1/2 transform -translate-y-1/2"}),(0,a.jsx)("div",{style:{left:"".concat((d-t)/(r-t)*100,"%"),right:"".concat(100-(m-t)/(r-t)*100,"%")},className:"jsx-4d3a686f648d85ae absolute h-1 bg-blue-500 rounded top-1/2 transform -translate-y-1/2"}),(0,a.jsx)("input",{type:"range",min:t,max:r,step:l,value:d,onChange:e=>{let t=Math.min(Number(e.target.value),m-l);u(t),c(t,m)},style:{"--thumb-size":"1rem","--thumb-color":"#fff","--thumb-border":"#3b82f6","--thumb-shadow":"0 1px 3px rgba(0,0,0,0.2)"},className:"jsx-4d3a686f648d85ae absolute w-full h-2 appearance-none bg-transparent pointer-events-none"}),(0,a.jsx)("input",{type:"range",min:t,max:r,step:l,value:m,onChange:e=>{let t=Math.max(Number(e.target.value),d+l);x(t),c(d,t)},style:{"--thumb-size":"1rem","--thumb-color":"#fff","--thumb-border":"#3b82f6","--thumb-shadow":"0 1px 3px rgba(0,0,0,0.2)"},className:"jsx-4d3a686f648d85ae absolute w-full h-2 appearance-none bg-transparent pointer-events-none"})]}),(0,a.jsx)(o(),{id:"4d3a686f648d85ae",children:'input[type="range"].jsx-4d3a686f648d85ae{-webkit-appearance:none;pointer-events:auto}input[type="range"].jsx-4d3a686f648d85ae::-webkit-slider-thumb{-webkit-appearance:none;height:var(--thumb-size);width:var(--thumb-size);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;background:var(--thumb-color);border:2px solid var(--thumb-border);-webkit-box-shadow:var(--thumb-shadow);-moz-box-shadow:var(--thumb-shadow);box-shadow:var(--thumb-shadow);cursor:pointer;pointer-events:auto;margin-top:-7px}input[type="range"].jsx-4d3a686f648d85ae::-moz-range-thumb{height:var(--thumb-size);width:var(--thumb-size);-webkit-border-radius:50%;-moz-border-radius:50%;border-radius:50%;background:var(--thumb-color);border:2px solid var(--thumb-border);-webkit-box-shadow:var(--thumb-shadow);-moz-box-shadow:var(--thumb-shadow);box-shadow:var(--thumb-shadow);cursor:pointer;pointer-events:auto}'})]})}function d(e){let{minYear:t,maxYear:r,initialMinYear:s=r,initialMaxYear:l=r,onChange:n}=e,i=Array.from({length:r-t+1},(e,t)=>r-t);return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("select",{value:s,onChange:e=>{let t=Number(e.target.value);n(t,Math.max(t,l))},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[(0,a.jsx)("option",{value:"",children:"Ann\xe9e min"}),i.map(e=>(0,a.jsx)("option",{value:e,disabled:e>l,children:e},e))]}),(0,a.jsx)("span",{className:"text-gray-500",children:"\xe0"}),(0,a.jsxs)("select",{value:l,onChange:e=>{let t=Number(e.target.value);n(Math.min(s,t),t)},className:"block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[(0,a.jsx)("option",{value:"",children:"Ann\xe9e max"}),i.map(e=>(0,a.jsx)("option",{value:e,disabled:e<s,children:e},e))]})]})}function u(e){let{initialMinMileage:t,initialMaxMileage:r,onChange:s}=e,l=e=>new Intl.NumberFormat("fr-FR").format(e),n=e=>Number(e.replace(/\D/g,""));return(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"relative rounded-md shadow-sm flex-1",children:[(0,a.jsx)("input",{type:"text",defaultValue:t?l(t):"",onChange:e=>{s(""===e.target.value?void 0:n(e.target.value),r)},onBlur:e=>{""!==e.target.value&&(e.target.value=l(n(e.target.value)))},placeholder:"Min",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,a.jsx)("span",{className:"text-gray-500 sm:text-sm",children:"km"})})]}),(0,a.jsx)("span",{className:"text-gray-500",children:"\xe0"}),(0,a.jsxs)("div",{className:"relative rounded-md shadow-sm flex-1",children:[(0,a.jsx)("input",{type:"text",defaultValue:r?l(r):"",onChange:e=>{s(t,""===e.target.value?void 0:n(e.target.value))},onBlur:e=>{""!==e.target.value&&(e.target.value=l(n(e.target.value)))},placeholder:"Max",className:"block w-full rounded-md border-gray-300 pl-3 pr-12 focus:border-blue-500 focus:ring-blue-500 sm:text-sm"}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center pr-3",children:(0,a.jsx)("span",{className:"text-gray-500 sm:text-sm",children:"km"})})]})]})}var m=r(6672);function x(e){let{options:t,selected:r,onChange:l,placeholder:n="S\xe9lectionner...",label:i}=e,[o,c]=(0,s.useState)(!1),d=(0,s.useRef)(null);(0,s.useEffect)(()=>{let e=e=>{d.current&&!d.current.contains(e.target)&&c(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]);let u=e=>{l(r.includes(e)?r.filter(t=>t!==e):[...r,e])};return(0,a.jsxs)("div",{className:"relative",ref:d,children:[i&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:i}),(0,a.jsxs)("button",{type:"button",className:"relative w-full bg-white border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-pointer focus:outline-none focus:ring-1 focus:ring-blue-500 focus:border-blue-500 sm:text-sm",onClick:()=>c(!o),children:[(0,a.jsx)("span",{className:"block truncate",children:(()=>{if(0===r.length)return n;if(1===r.length){var e;return null===(e=t.find(e=>e.value===r[0]))||void 0===e?void 0:e.label}return"".concat(r.length," s\xe9lectionn\xe9s")})()}),(0,a.jsx)("span",{className:"absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:(0,a.jsx)("svg",{className:"h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M10 3a1 1 0 01.707.293l3 3a1 1 0 01-1.414 1.414L10 5.414 7.707 7.707a1 1 0 01-1.414-1.414l3-3A1 1 0 0110 3zm-3.707 9.293a1 1 0 011.414 0L10 14.586l2.293-2.293a1 1 0 011.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),(0,a.jsx)(m.u,{show:o,enter:"transition ease-out duration-100",enterFrom:"transform opacity-0 scale-95",enterTo:"transform opacity-100 scale-100",leave:"transition ease-in duration-75",leaveFrom:"transform opacity-100 scale-100",leaveTo:"transform opacity-0 scale-95",children:(0,a.jsx)("div",{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-60 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:t.map(e=>(0,a.jsx)("div",{className:"relative px-4 py-2 hover:bg-gray-100 cursor-pointer",onClick:()=>u(e.value),children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",checked:r.includes(e.value),onChange:()=>{}}),(0,a.jsx)("span",{className:"ml-3 block truncate",children:e.label})]})},e.value))})})]})}function h(e){let{colors:t,selected:r,onChange:s,label:l="Couleurs"}=e,n=e=>{s(r.includes(e)?r.filter(t=>t!==e):[...r,e])};return(0,a.jsxs)("div",{children:[l&&(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:l}),(0,a.jsx)("div",{className:"grid grid-cols-4 gap-2",children:t.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>n(e.value),className:"group relative flex items-center justify-center p-0.5 rounded-full focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ".concat(r.includes(e.value)?"ring-2 ring-blue-500":"ring-1 ring-gray-200"),children:[(0,a.jsx)("span",{className:"h-8 w-8 rounded-full border border-black border-opacity-10",style:{backgroundColor:e.hex}}),(0,a.jsx)("span",{className:"sr-only",children:e.label}),(0,a.jsx)("div",{className:"absolute bottom-full mb-2 hidden group-hover:block",children:(0,a.jsxs)("div",{className:"bg-gray-900 text-white text-xs rounded py-1 px-2 whitespace-nowrap",children:[e.label,(0,a.jsx)("svg",{className:"absolute text-gray-900 h-2 w-full left-0 top-full",x:"0px",y:"0px",viewBox:"0 0 255 255",xmlSpace:"preserve",children:(0,a.jsx)("polygon",{className:"fill-current",points:"0,0 127.5,127.5 255,0"})})]})})]},e.value))})]})}function g(e){let{sections:t,defaultOpenSections:r=[0]}=e,[l,n]=(0,s.useState)(r),i=e=>{n(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsx)("div",{className:"divide-y divide-gray-200",children:t.map((e,t)=>(0,a.jsxs)("div",{className:"py-4",children:[(0,a.jsxs)("button",{className:"flex w-full items-center justify-between text-left",onClick:()=>i(t),children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-900",children:e.title}),(0,a.jsx)("span",{className:"ml-6 flex items-center",children:l.includes(t)?(0,a.jsx)("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}):(0,a.jsx)("svg",{className:"h-5 w-5 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})})]}),l.includes(t)&&(0,a.jsx)("div",{className:"mt-4",children:e.content})]},t))})}function b(e){let{onFiltersChange:t,initialFilters:r={}}=e,[l,n]=(0,s.useState)(r),i=(e,r)=>{let a={...l,[e]:r};n(a),t(a)},o=[{title:"Prix",content:(0,a.jsx)(c,{min:0,max:1e5,step:1e3,initialMin:l.minPrice,initialMax:l.maxPrice,onChange:(e,t)=>{i("minPrice",e),i("maxPrice",t)}})},{title:"Ann\xe9e",content:(0,a.jsx)(d,{minYear:1990,maxYear:new Date().getFullYear(),initialMinYear:l.minYear,initialMaxYear:l.maxYear,onChange:(e,t)=>{i("minYear",e),i("maxYear",t)}})},{title:"Kilom\xe9trage",content:(0,a.jsx)(u,{initialMinMileage:l.minMileage,initialMaxMileage:l.maxMileage,onChange:(e,t)=>{i("minMileage",e),i("maxMileage",t)}})},{title:"Carburant",content:(0,a.jsx)(x,{options:[{value:"essence",label:"Essence"},{value:"diesel",label:"Diesel"},{value:"hybride",label:"Hybride"},{value:"electrique",label:"\xc9lectrique"}],selected:l.fuelTypes||[],onChange:e=>i("fuelTypes",e),placeholder:"S\xe9lectionner le type de carburant"})},{title:"Transmission",content:(0,a.jsx)(x,{options:[{value:"manuelle",label:"Manuelle"},{value:"automatique",label:"Automatique"}],selected:l.transmissionTypes||[],onChange:e=>i("transmissionTypes",e),placeholder:"S\xe9lectionner le type de transmission"})},{title:"Couleur",content:(0,a.jsx)(h,{colors:[{value:"blanc",label:"Blanc",hex:"#FFFFFF"},{value:"noir",label:"Noir",hex:"#000000"},{value:"gris",label:"Gris",hex:"#808080"},{value:"rouge",label:"Rouge",hex:"#FF0000"},{value:"bleu",label:"Bleu",hex:"#0000FF"},{value:"vert",label:"Vert",hex:"#008000"},{value:"marron",label:"Marron",hex:"#8B4513"},{value:"beige",label:"Beige",hex:"#F5F5DC"}],selected:l.colors||[],onChange:e=>i("colors",e)})}];return(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Filtres"}),(0,a.jsx)(g,{sections:o}),(0,a.jsx)("div",{className:"mt-6 flex justify-end",children:(0,a.jsx)("button",{type:"button",onClick:()=>{n({}),t({})},className:"text-sm text-gray-500 hover:text-gray-700",children:"R\xe9initialiser les filtres"})})]})}var p=r(1370);function f(e){let{currentSort:t,currentOrder:r,onSortChange:s}=e;return(0,a.jsxs)("div",{className:"flex items-center space-x-4 mb-6",children:[(0,a.jsx)("label",{htmlFor:"sort",className:"text-sm font-medium text-gray-700",children:"Trier par:"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("select",{id:"sort",className:"block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md",value:"".concat(t,"-").concat(r),onChange:e=>{let[t,r]=e.target.value.split("-");s(t,r)},children:[{label:"Prix croissant",value:"price",order:"asc"},{label:"Prix d\xe9croissant",value:"price",order:"desc"},{label:"Ann\xe9e r\xe9cente",value:"year",order:"desc"},{label:"Ann\xe9e ancienne",value:"year",order:"asc"},{label:"Kilom\xe9trage croissant",value:"mileage",order:"asc"},{label:"Kilom\xe9trage d\xe9croissant",value:"mileage",order:"desc"},{label:"Date d'ajout",value:"createdAt",order:"desc"}].map(e=>(0,a.jsx)("option",{value:"".concat(e.value,"-").concat(e.order),children:e.label},"".concat(e.value,"-").concat(e.order)))}),(0,a.jsx)("div",{className:"pointer-events-none absolute inset-y-0 right-0 flex items-center px-2 text-gray-700",children:(0,a.jsx)("svg",{className:"h-4 w-4",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{fillRule:"evenodd",d:"M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z",clipRule:"evenodd"})})})]})]})}function v(e){let{cars:t,total:r,filters:s}=e,l=e=>new Intl.NumberFormat("fr-FR",{style:"currency",currency:"EUR",maximumFractionDigits:0}).format(e),n=(()=>{if(0===t.length)return{min:0,max:0};let e=t.map(e=>e.price);return{min:Math.min(...e),max:Math.max(...e)}})(),i=(()=>{if(0===t.length)return{min:0,max:0};let e=t.map(e=>e.year);return{min:Math.min(...e),max:Math.max(...e)}})(),o=0===t.length?0:Math.round(t.reduce((e,t)=>e+t.price,0)/t.length),c=Object.entries(s).filter(e=>{let[t,r]=e;return Array.isArray(r)?r.length>0:"object"==typeof r&&null!==r?Object.values(r).some(e=>void 0!==e&&""!==e):void 0!==r&&""!==r}).length;return(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg p-6 mb-6",children:[(0,a.jsx)("h2",{className:"text-lg font-medium text-gray-900 mb-4",children:"Statistiques de recherche"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"R\xe9sultats"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:r}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:[c," filtre",1!==c?"s":""," actif",1!==c?"s":""]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Prix moyen"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:l(o)}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["sur ",t.length," r\xe9sultat",1!==t.length?"s":""]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Fourchette de prix"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:l(n.min)}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["\xe0 ",l(n.max)]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Ann\xe9es"}),(0,a.jsx)("p",{className:"mt-1 text-2xl font-semibold text-gray-900",children:i.min}),(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["\xe0 ",i.max]})]})]})]})}function j(e){let{message:t="Aucun r\xe9sultat trouv\xe9",suggestion:r="Essayez de modifier vos crit\xe8res de recherche",onReset:s}=e;return(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","aria-hidden":"true",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),(0,a.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:t}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:r}),s&&(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)("button",{type:"button",onClick:s,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"R\xe9initialiser les filtres"})})]})}function y(e){let{currentPage:t,totalPages:r,onPageChange:s}=e,l=Array.from({length:r},(e,t)=>t+1),n=(()=>{if(r<=5)return l;let e=Math.floor(2.5),a=t-e,s=t+e;return a<1&&(a=1,s=5),s>r&&(s=r,a=r-5+1),l.slice(a-1,s)})();return(0,a.jsxs)("nav",{className:"flex items-center justify-between border-t border-gray-200 px-4 sm:px-0 mt-6",children:[(0,a.jsx)("div",{className:"-mt-px flex w-0 flex-1",children:(0,a.jsxs)("button",{onClick:()=>s(t-1),disabled:1===t,className:"inline-flex items-center border-t-2 pt-4 pr-1 text-sm font-medium ".concat(1===t?"border-transparent text-gray-400 cursor-not-allowed":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:[(0,a.jsx)("svg",{className:"mr-3 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Pr\xe9c\xe9dent"]})}),(0,a.jsxs)("div",{className:"hidden md:-mt-px md:flex",children:[t>5&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:()=>s(1),className:"inline-flex items-center border-t-2 border-transparent px-4 pt-4 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700",children:"1"}),t>6&&(0,a.jsx)("span",{className:"inline-flex items-center border-t-2 border-transparent px-4 pt-4 text-sm font-medium text-gray-500",children:"..."})]}),n.map(e=>(0,a.jsx)("button",{onClick:()=>s(e),className:"inline-flex items-center border-t-2 px-4 pt-4 text-sm font-medium ".concat(t===e?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:e},e)),t<r-3&&(0,a.jsxs)(a.Fragment,{children:[t<r-4&&(0,a.jsx)("span",{className:"inline-flex items-center border-t-2 border-transparent px-4 pt-4 text-sm font-medium text-gray-500",children:"..."}),(0,a.jsx)("button",{onClick:()=>s(r),className:"inline-flex items-center border-t-2 border-transparent px-4 pt-4 text-sm font-medium text-gray-500 hover:border-gray-300 hover:text-gray-700",children:r})]})]}),(0,a.jsx)("div",{className:"-mt-px flex w-0 flex-1 justify-end",children:(0,a.jsxs)("button",{onClick:()=>s(t+1),disabled:t===r,className:"inline-flex items-center border-t-2 pt-4 pl-1 text-sm font-medium ".concat(t===r?"border-transparent text-gray-400 cursor-not-allowed":"border-transparent text-gray-500 hover:border-gray-300 hover:text-gray-700"),children:["Suivant",(0,a.jsx)("svg",{className:"ml-3 h-5 w-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})]})}function N(e){let{cars:t,total:r,filters:s,loading:l=!1,onSortChange:n,onPageChange:i,currentPage:o,totalPages:c,currentSort:d,currentOrder:u,onFavoriteToggle:m,favorites:x}=e;return l?(0,a.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):0===t.length?(0,a.jsx)(j,{message:"Aucun r\xe9sultat trouv\xe9",suggestion:"Essayez de modifier vos crit\xe8res de recherche"}):(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(v,{cars:t,total:r,filters:s})}),(0,a.jsx)("div",{className:"mb-6",children:(0,a.jsx)(f,{currentSort:d,currentOrder:u,onSortChange:n})}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:t.map(e=>(0,a.jsx)(p.Z,{car:e,isFavorite:x.includes(e._id),onFavoriteToggle:()=>m(e._id)},e._id))}),c>1&&(0,a.jsx)(y,{currentPage:o,totalPages:c,onPageChange:i})]})}var w=r(7066),k=r(6501);function C(){let e=(0,l.useRouter)(),[t,r]=(0,s.useState)([]),[i,o]=(0,s.useState)(!0),[c,d]=(0,s.useState)(0),[u,m]=(0,s.useState)(0),[x,h]=(0,s.useState)(1),[g,p]=(0,s.useState)("createdAt"),[f,v]=(0,s.useState)("desc"),[j,y]=(0,s.useState)({}),[C,M]=(0,s.useState)([]);(0,s.useEffect)(()=>{let t=e.query;if(Object.keys(t).length>0){let{page:e,sort:r,order:a,...s}=t;h(Number(e)||1),p(r||"createdAt"),v(a||"desc"),y(s)}L()},[e.query]),(0,s.useEffect)(()=>{F()},[]);let F=async()=>{try{let e=await w.Z.get("/api/favorites");M(e.data.favorites.map(e=>e._id))}catch(e){}},L=async()=>{try{o(!0);let t=new URLSearchParams({page:x.toString(),sort:g,order:f,...j}),a=await w.Z.get("/api/cars?".concat(t.toString()));r(a.data.cars),d(a.data.total),m(Math.ceil(a.data.total/12)),e.push({pathname:"/search",query:t.toString()},void 0,{shallow:!0})}catch(e){k.ZP.error("Erreur lors de la recherche")}finally{o(!1)}},S=async e=>{await F()};return(0,a.jsx)(n.Z,{children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-8",children:"Rechercher une voiture"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsx)(b,{onFiltersChange:e=>{y(e),h(1),L()},initialFilters:j})}),(0,a.jsx)("div",{className:"lg:col-span-3",children:(0,a.jsx)(N,{cars:t,total:c,filters:j,loading:i,onSortChange:(e,t)=>{p(e),v(t),L()},onPageChange:e=>{h(e),L()},currentPage:x,totalPages:u,currentSort:g,currentOrder:f,onFavoriteToggle:S,favorites:C})})]})]})})}}},function(e){e.O(0,[424,675,128,618,755,888,774,179],function(){return e(e.s=8266)}),_N_E=e.O()}]);